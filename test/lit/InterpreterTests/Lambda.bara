// RUN: bara %s -interpret | FileCheck %s


var getUniqueNumber = (\ => {
  var a = 0;
  return \ => {
    a += 1;
    return a;
  };
})();

print(getUniqueNumber());
// CHECK: 1

print(getUniqueNumber());
// CHECK: 2

print(getUniqueNumber());
// CHECK: 3


var outOfLambda = 0;

var inLambda = \ => {
  outOfLambda += 1;
  return outOfLambda;
};

print(inLambda());
// CHECK: 1

print(outOfLambda);
// CHECK: 0

print(inLambda());
// CHECK: 2

print(outOfLambda);
// CHECK: 0


var fibo = {
  var fiboImpl = \fiboCallee, x => {
    if (x <= 1) {
      return x;
    } else {
      return fiboCallee(fiboCallee, x - 1) + fiboCallee(fiboCallee, x - 2);
    }
  };
  \x => {
    return fiboImpl(fiboImpl, x);
  }
};

print(fibo(6));
// CHECK: 8


var counter2 = {
  var count = 0;
  \ => {
    count += 1
  }
};

print(counter2());
// CHECK: 1
print(counter2());
// CHECK: 2
